<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Convert multiple images into a single PDF with ToolGenie's free and fast Images to PDF converter." />
  <title>Images to PDF Converter - ToolGenie</title>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="icon" href="../assets/favicon.png" type="image/png" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <div class="container">
    <h1 class="heading">üñºÔ∏è Images to PDF</h1>
    <p class="subheading">Upload multiple images and convert them into a single PDF file</p>

    <div class="tool-card">
      <div class="drop-area" id="dropArea">
        <p>Drag & drop images here or click to select</p>
        <input type="file" id="imageInput" class="input" accept="image/*" multiple hidden />
      </div>

      <div id="preview" class="output"></div>

      <button class="button" onclick="generatePDF()">Convert to PDF</button>
    </div>
  </div>

  <div id="loader" class="loader hidden"></div>

  <script>
    const dropArea = document.getElementById("dropArea");
    const imageInput = document.getElementById("imageInput");
    const preview = document.getElementById("preview");
    const loader = document.getElementById("loader");

    dropArea.addEventListener("click", () => imageInput.click());

    dropArea.addEventListener("dragover", (e) => {
      e.preventDefault();
      dropArea.classList.add("active");
    });

    dropArea.addEventListener("dragleave", () => {
      dropArea.classList.remove("active");
    });

    dropArea.addEventListener("drop", (e) => {
      e.preventDefault();
      dropArea.classList.remove("active");
      const files = Array.from(e.dataTransfer.files);
      handleFiles(files);
    });

    imageInput.addEventListener("change", () => {
      handleFiles(Array.from(imageInput.files));
    });

    let imageFiles = [];

    function handleFiles(files) {
      imageFiles = files.filter(file => file.type.startsWith("image/"));
      preview.innerHTML = "";

      if (imageFiles.length === 0) {
        preview.innerHTML = "<p>No images selected.</p>";
        return;
      }

      imageFiles.forEach((file) => {
        const reader = new FileReader();
        reader.onload = function (e) {
          const img = document.createElement("img");
          img.src = e.target.result;
          img.style.maxWidth = "100px";
          img.style.margin = "5px";
          img.style.borderRadius = "8px";
          preview.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    }

    async function generatePDF() {
      if (imageFiles.length === 0) {
        alert("Please select at least one image.");
        return;
      }

      loader.classList.remove("hidden");

      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();

      for (let i = 0; i < imageFiles.length; i++) {
        const file = imageFiles[i];
        const imgData = await fileToDataURL(file);

        const img = new Image();
        img.src = imgData;

        await new Promise((resolve) => {
          img.onload = () => {
            const width = pdf.internal.pageSize.getWidth();
            const height = (img.height * width) / img.width;
            if (i !== 0) pdf.addPage();
            pdf.addImage(img, "JPEG", 0, 0, width, height);
            resolve();
          };
        });
      }

      pdf.save("images-to-pdf.pdf");
      loader.classList.add("hidden");
    }

    function fileToDataURL(file) {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.readAsDataURL(file);
      });
    }
  </script>
</body>
</html>
