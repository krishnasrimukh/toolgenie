<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Compressor - Free Online Tool | TOOLGENIE</title>
    <meta name="description" content="Free online image compressor tool. Reduce image file size without losing quality. Supports JPG, PNG, GIF, and WebP formats. No installation needed.">
    <meta name="keywords" content="image compressor, compress images online, reduce image size, free image optimizer, JPG compressor, PNG compressor, toolgenie">
    <meta name="author" content="TOOLGENIE">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://toolgenie.in/tools/image-compressor.html">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://toolgenie.in/tools/image-compressor.html">
    <meta property="og:title" content="Image Compressor - Free Online Tool | TOOLGENIE">
    <meta property="og:description" content="Free online image compressor tool. Reduce image file size without losing quality. Supports JPG, PNG, GIF, and WebP formats.">
    <meta property="og:image" content="https://toolgenie.in/assets/images/toolgenie-logo.png">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://toolgenie.in/tools/image-compressor.html">
    <meta property="twitter:title" content="Image Compressor - Free Online Tool | TOOLGENIE">
    <meta property="twitter:description" content="Free online image compressor tool. Reduce image file size without losing quality. Supports JPG, PNG, GIF, and WebP formats.">
    <meta property="twitter:image" content="https://toolgenie.in/assets/images/toolgenie-logo.png">
    
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="../assets/icons/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Image Compressor Specific Styles */
        .image-compressor {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
        
        .upload-area:hover {
            border-color: #3498db;
            background-color: #eaf2f8;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #3498db;
            margin-bottom: 1rem;
        }
        
        .file-input {
            display: none;
        }
        
        .upload-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .upload-btn:hover {
            background-color: #2980b9;
        }
        
        .file-previews {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .file-preview {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 0.5rem;
            background: white;
        }
        
        .file-thumbnail {
            width: 100%;
            height: 100px;
            object-fit: contain;
            margin-bottom: 0.5rem;
        }
        
        .file-info {
            font-size: 0.8rem;
            color: #555;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .progress-container {
            width: 100%;
            margin: 1rem 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s;
        }
        
        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }
        
        .compression-controls {
            display: flex;
            gap: 1rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }
        
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .control-group input[type="range"] {
            width: 100%;
        }
        
        .control-group input[type="number"] {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .action-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .action-btn:hover {
            background-color: #27ae60;
        }
        
        .action-btn.secondary {
            background-color: #95a5a6;
        }
        
        .action-btn.secondary:hover {
            background-color: #7f8c8d;
        }
        
        .results-container {
            margin-top: 2rem;
            display: none;
        }
        
        .result-item {
            display: flex;
            gap: 1rem;
            align-items: center;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 1rem;
            background: white;
        }
        
        .result-thumbnail {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border: 1px solid #eee;
        }
        
        .result-info {
            flex: 1;
        }
        
        .result-name {
            font-weight: 500;
            margin-bottom: 0.3rem;
        }
        
        .result-stats {
            font-size: 0.9rem;
            color: #666;
        }
        
        .download-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }
        
        .download-btn:hover {
            background-color: #2980b9;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 600px) {
            .file-previews {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .compression-controls {
                flex-direction: column;
                gap: 1rem;
            }
            
            .result-item {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="brand">
                <img src="../assets/images/toolgenie-logo.png" alt="TOOLGENIE Logo" class="logo">
                <span>TOOLGENIE</span>
            </a>
            <div class="search-container">
                <input type="text" placeholder="Search tools..." class="search-bar">
                <button class="search-btn">Search</button>
            </div>
            <div class="nav-links">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="../about.html" class="nav-link">About</a>
                <a href="../contact.html" class="nav-link">Contact</a>
            </div>
            <button class="mobile-menu-btn">☰</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Ad Space (Top) -->
        <div class="ad-space">
            <!-- Google AdSense Code will go here -->
            <p>Advertisement</p>
        </div>

        <!-- Tool Container -->
        <section class="tool-container">
            <h1>Image Compressor</h1>
            <p class="tool-description">Reduce the file size of your images without significant quality loss. Perfect for optimizing images for websites, emails, or social media. Supports JPG, PNG, GIF, and WebP formats.</p>
            
            <!-- Tool Interface -->
            <div class="tool-interface">
                <div class="image-compressor">
                    <div class="upload-area" id="dropArea">
                        <input type="file" id="fileInput" accept="image/*" multiple class="file-input">
                        <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <h3>Drag & Drop your images here</h3>
                        <p>or</p>
                        <button id="selectFileBtn" class="upload-btn"><i class="fas fa-folder-open"></i> Select Images</button>
                    </div>
                    
                    <div id="filePreviews" class="file-previews"></div>
                    
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">Uploading files...</div>
                    </div>
                    
                    <div class="compression-controls" id="compressionControls" style="display: none;">
                        <div class="control-group">
                            <label for="quality">Quality: <span id="qualityValue">80%</span></label>
                            <input type="range" id="quality" min="10" max="100" value="80">
                        </div>
                        <div class="control-group">
                            <label for="targetSize">Target Size (KB):</label>
                            <input type="number" id="targetSize" min="10" placeholder="Leave empty for quality-based">
                        </div>
                    </div>
                    
                    <div class="action-buttons" id="actionButtons" style="display: none;">
                        <button id="compressBtn" class="action-btn"><i class="fas fa-compress-alt"></i> Compress Images</button>
                    </div>
                    
                    <div class="results-container" id="resultsContainer">
                        <h3>Compressed Results</h3>
                        <div id="resultsList"></div>
                        <div class="action-buttons">
                            <button id="newImagesBtn" class="action-btn secondary"><i class="fas fa-redo"></i> Compress More Images</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rest of your existing content remains unchanged -->
            <!-- Tool Features, How To Use, FAQ sections -->
        </section>

        <!-- Ad Space (Middle) -->
        <div class="ad-space">
            <!-- Google AdSense Code will go here -->
            <p>Advertisement</p>
        </div>

        <!-- How To Use Section -->
        <section class="how-to-use">
            <!-- Your existing how-to-use content -->
        </section>

        <!-- FAQ Section -->
        <section class="faq">
            <!-- Your existing FAQ content -->
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <!-- Your existing footer content -->
    </footer>

    <script src="../js/main.js"></script>
    <script>
        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const selectFileBtn = document.getElementById('selectFileBtn');
        const dropArea = document.getElementById('dropArea');
        const filePreviews = document.getElementById('filePreviews');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const qualitySlider = document.getElementById('quality');
        const qualityValue = document.getElementById('qualityValue');
        const targetSizeInput = document.getElementById('targetSize');
        const compressionControls = document.getElementById('compressionControls');
        const actionButtons = document.getElementById('actionButtons');
        const compressBtn = document.getElementById('compressBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const resultsList = document.getElementById('resultsList');
        const newImagesBtn = document.getElementById('newImagesBtn');
        
        // State variables
        let files = [];
        let compressedFiles = [];
        
        // Event Listeners
        selectFileBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);
        dropArea.addEventListener('dragover', handleDragOver);
        dropArea.addEventListener('dragleave', handleDragLeave);
        dropArea.addEventListener('drop', handleDrop);
        qualitySlider.addEventListener('input', updateQualityValue);
        compressBtn.addEventListener('click', compressImages);
        newImagesBtn.addEventListener('click', resetTool);
        
        // Functions
        function handleFileSelect(e) {
            const newFiles = Array.from(e.target.files);
            if (newFiles.length > 0) {
                processFiles(newFiles);
            }
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.add('dragover');
        }
        
        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.remove('dragover');
            
            const newFiles = Array.from(e.dataTransfer.files);
            if (newFiles.length > 0) {
                processFiles(newFiles);
            }
        }
        
        function processFiles(newFiles) {
            // Filter only image files
            const imageFiles = newFiles.filter(file => file.type.match('image.*'));
            
            if (imageFiles.length === 0) {
                alert('Please select image files (JPEG, PNG, GIF, or WebP)');
                return;
            }
            
            // Add to our files array
            files = [...files, ...imageFiles];
            
            // Show upload progress
            showUploadProgress();
            
            // Process each file to show previews
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    addFilePreview(file, e.target.result, index);
                    
                    // Update progress
                    const percent = ((index + 1) / files.length) * 100;
                    progressFill.style.width = `${percent}%`;
                    progressText.textContent = `Processed ${index + 1} of ${files.length} files`;
                    
                    // If all files processed, show controls
                    if (index === files.length - 1) {
                        setTimeout(() => {
                            progressContainer.style.display = 'none';
                            compressionControls.style.display = 'flex';
                            actionButtons.style.display = 'flex';
                        }, 500);
                    }
                };
                reader.readAsDataURL(file);
            });
        }
        
        function showUploadProgress() {
            progressContainer.style.display = 'block';
            progressFill.style.width = '0%';
            progressText.textContent = 'Processing files...';
        }
        
        function addFilePreview(file, dataUrl, index) {
            const filePreview = document.createElement('div');
            filePreview.className = 'file-preview';
            filePreview.innerHTML = `
                <img src="${dataUrl}" class="file-thumbnail" alt="Preview">
                <div class="file-info">
                    <div>${file.name}</div>
                    <div>${formatFileSize(file.size)}</div>
                </div>
            `;
            filePreviews.appendChild(filePreview);
        }
        
        function updateQualityValue() {
            qualityValue.textContent = `${qualitySlider.value}%`;
        }
        
        function compressImages() {
            if (files.length === 0) return;
            
            // Show loading state
            compressBtn.innerHTML = '<span class="spinner"></span> Compressing...';
            compressBtn.disabled = true;
            
            // Clear previous results
            resultsList.innerHTML = '';
            
            // Process each file
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        compressImage(file, img, index);
                        
                        // If last file, show results
                        if (index === files.length - 1) {
                            setTimeout(() => {
                                compressBtn.innerHTML = '<i class="fas fa-compress-alt"></i> Compress Images';
                                compressBtn.disabled = false;
                                showResults();
                            }, 500);
                        }
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }
        
        function compressImage(file, img, index) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = img.width;
            canvas.height = img.height;
            
            // Draw image
            ctx.drawImage(img, 0, 0);
            
            // Get quality setting
            let quality = parseInt(qualitySlider.value) / 100;
            
            // If target size is specified, adjust quality to meet it
            const targetKB = parseInt(targetSizeInput.value);
            if (targetKB && !isNaN(targetKB)) {
                quality = calculateQualityForTargetSize(canvas, file.type, targetKB * 1024);
            }
            
            // Convert to blob with specified quality
            canvas.toBlob(function(blob) {
                if (!blob) return;
                
                // Create result object
                const result = {
                    originalFile: file,
                    compressedFile: blob,
                    originalSize: file.size,
                    compressedSize: blob.size,
                    quality: Math.round(quality * 100)
                };
                
                compressedFiles[index] = result;
                
                // Add to results list
                addResultItem(result, index);
                
            }, file.type, quality);
        }
        
        function calculateQualityForTargetSize(canvas, mimeType, targetBytes) {
            // Binary search to find appropriate quality
            let min = 0.1;
            let max = 1.0;
            let quality = 0.8;
            let blob;
            
            for (let i = 0; i < 10; i++) { // Limit iterations
                blob = canvasToBlobSync(canvas, mimeType, quality);
                if (!blob) break;
                
                const size = blob.size;
                
                if (Math.abs(size - targetBytes) < targetBytes * 0.05) { // Within 5% tolerance
                    break;
                } else if (size > targetBytes) {
                    max = quality;
                    quality = (min + quality) / 2;
                } else {
                    min = quality;
                    quality = (max + quality) / 2;
                }
            }
            
            return quality;
        }
        
        function canvasToBlobSync(canvas, mimeType, quality) {
            // This is a simplified synchronous version (not ideal for production)
            const dataURL = canvas.toDataURL(mimeType, quality);
            const binaryString = atob(dataURL.split(',')[1]);
            const bytes = new Uint8Array(binaryString.length);
            
            for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            
            return new Blob([bytes], { type: mimeType });
        }
        
        function addResultItem(result, index) {
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';
            
            const url = URL.createObjectURL(result.compressedFile);
            const savings = result.originalSize - result.compressedSize;
            const percent = (savings / result.originalSize * 100).toFixed(1);
            
            resultItem.innerHTML = `
                <img src="${url}" class="result-thumbnail" alt="Compressed">
                <div class="result-info">
                    <div class="result-name">${result.originalFile.name}</div>
                    <div class="result-stats">
                        ${formatFileSize(result.originalSize)} → ${formatFileSize(result.compressedSize)} 
                        (${percent}% smaller, Quality: ${result.quality}%)
                    </div>
                </div>
                <button class="download-btn" data-index="${index}"><i class="fas fa-download"></i> Download</button>
            `;
            
            resultsList.appendChild(resultItem);
            
            // Add download event listener
            resultItem.querySelector('.download-btn').addEventListener('click', () => {
                downloadResult(index);
            });
        }
        
        function downloadResult(index) {
            const result = compressedFiles[index];
            if (!result) return;
            
            const url = URL.createObjectURL(result.compressedFile);
            const a = document.createElement('a');
            a.href = url;
            
            // Create filename (original name + compressed)
            const originalName = result.originalFile.name;
            const extension = originalName.split('.').pop();
            a.download = originalName.replace(`.${extension}`, `-compressed.${extension}`);
            
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function showResults() {
            // Hide controls, show results
            compressionControls.style.display = 'none';
            actionButtons.style.display = 'none';
            filePreviews.innerHTML = '';
            resultsContainer.style.display = 'block';
        }
        
        function resetTool() {
            // Reset all elements
            fileInput.value = '';
            files = [];
            compressedFiles = [];
            
            dropArea.style.display = 'flex';
            filePreviews.innerHTML = '';
            progressContainer.style.display = 'none';
            compressionControls.style.display = 'none';
            actionButtons.style.display = 'none';
            resultsContainer.style.display = 'none';
            
            // Reset form values
            qualitySlider.value = 80;
            qualityValue.textContent = '80%';
            targetSizeInput.value = '';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Initialize
        updateQualityValue();
    </script>
</body>
</html>
